# PostgreSQL_Backup
Этот скрипт позволяет выполнять **репликацию БД PostgreSQL**
>sh ./pg_backup_starter [/path/to/backup-storage|d] [username|d] [password|d]

Пример: ./pg_backup_starter /mystorage/backup_folder postgres password2112 

# Зависимости
## Пользователь
### **[username|d]** & **[password|d]**

Необходимо, чтобы был отдельный пользователь для выполнения бэкапа имеющий доступ к базам данных, либо пользователь по умолчанию - **postgres**; Чтобы использовать **postgres**, вместо **[username|d]**, введите имя **postgres** или **d**.

Укажите пароль заменив **[password|d]** на ваш пароль, или введите **'d'**, чтобы использовать пароль по умолчанию (**'xxXX1234'**)

По умолчанию, у **postgres** нет логина по паролю.  
Чтобы использовать пользователя **postgres** нужно задать ему пароль:
> **#Подсоединитесь к консоли psql**\
 su postgres -c psql  \
**#Введите эту строку** \
 ALTER USER postgres WITH PASSWORD 'xxXX1234'; \
**#Выйдите из консоли psql**\
 \q

## Хранилище
### **[/path/to/backup-storage]**
По умолчанию, бэкап выполнится в каталог '/backups', если вы хотите указать другой путь для хранения бэкапа, то вместо **[/path/to/backup-storage]** укажите свой путь. 
Если вас устраивает место по умолчанию, введите **'d'**;
Если вы укажите **'d'**, но каталог **'/backup'** будет отсутсвовать, то скрипт создаст его сам.

# Принцип работы
**Выполнять только от 'root' !**\
**Выполнять только с запущенным БД PostgreSQL!**
## [0.*] Проверка Хранилища
Здесь выполняется проверка корректности, введенного вами пути к каталогу, содержащему бэкап. \
**Если каталог будет осутствовать или иметь недостаточные права на чтение+запись, то скрипт прервется!**
## [1.*] Пользователь
Здесь введенные данные username/password сравниваются с данными по умолчанию.
## [2.*] Создание резервной копии
На этом этапе, в каталоге бэкапов создается каталог с именем сегодняшней даты(В формате mm.dd.yyyy). После создается бэкап и размещается в новосозданный каталог. 
**Если БД будет выключена в этот момент, то скрипт завершится ошибкой!**